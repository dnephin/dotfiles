meta:
  project: vm-service

mount=source:
  bind: .
  path: /code

mount=m2:
  bind: ~/.m2
  path: /root/.m2

mount=lein-profile:
  bind: ~/.lein
  path: /root/.lein

image=dev:
  image: clojure-dev
  context: .
  steps: |
    FROM clojure:lein-2.8.1-alpine
    RUN apk add --no-cache openssh-keygen openssh
    WORKDIR /code

job=shell:
  use: dev
  interactive: true
  net-mode: vm-service_default
  mounts: [source, m2, lein-profile]
  command: bash
  env:
    - "GOOGLE_APPLICATION_CREDENTIALS=./config/config-dev-gce-credentials.json"
    - "PS1=# "

job=watch:
  use: dev
  interactive: true
  net-mode: vm-service_default
  mounts: [source, m2, lein-profile]
  command: scripts/watch
  env:
    - "GOOGLE_APPLICATION_CREDENTIALS=./config/config-dev-gce-credentials.json"

